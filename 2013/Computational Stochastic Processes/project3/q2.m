clear all
clc

Tmax = 10000;
dt = 0.01;
T = linspace(0, Tmax, Tmax/dt);

dW = dt*randn(1, length(T));
X = zeros(1,length(T));

X(1) = 0.0;

for i = 2:length(T)
    X(i) = X(i-1) - (8*X(i-1)^3 - 3*X(i-1)^2 - X(i-1) + 0.5)*dt + 0.5*dW(i);
end

M0 = dt;
M1 = sum(X)*dt;
M2 = sum(X.^2)*dt;
M3 = sum(X.^3)*dt;
M4 = sum(X.^4)*dt;
M5 = sum(X.^5)*dt;
M6 = sum(X.^6)*dt;
B0 = sum(diff(X));
B1 = sum(X(1:end-1).*diff(X));
B2 = sum((X(1:end-1).^2).*diff(X));
B3 = sum((X(1:end-1).^3).*diff(X));

S1 = (B0*(M6*M3^2 - 2*M3*M4*M5 + M4^3 - M2*M6*M4 + M2*M5^2))/(M6*M1^2*M4 - M1^2*M5^2 - 2*M6*M1*M2*M3 + 2*M1*M2*M4*M5 + 2*M1*M3^2*M5 - 2*M1*M3*M4^2 + M6*M2^3 - 2*M2^2*M3*M5 - M2^2*M4^2 + 3*M2*M3^2*M4 - M0*M6*M2*M4 + M0*M2*M5^2 - M3^4 + M0*M6*M3^2 - 2*M0*M3*M4*M5 + M0*M4^3) - (B1*(- M3^2*M5 + M3*M4^2 + M2*M6*M3 - M2*M4*M5 - M1*M6*M4 + M1*M5^2))/(M6*M1^2*M4 - M1^2*M5^2 - 2*M6*M1*M2*M3 + 2*M1*M2*M4*M5 + 2*M1*M3^2*M5 - 2*M1*M3*M4^2 + M6*M2^3 - 2*M2^2*M3*M5 - M2^2*M4^2 + 3*M2*M3^2*M4 - M0*M6*M2*M4 + M0*M2*M5^2 - M3^4 + M0*M6*M3^2 - 2*M0*M3*M4*M5 + M0*M4^3) - (B3*(M5*M2^2 - 2*M2*M3*M4 + M3^3 - M1*M5*M3 + M1*M4^2))/(M6*M1^2*M4 - M1^2*M5^2 - 2*M6*M1*M2*M3 + 2*M1*M2*M4*M5 + 2*M1*M3^2*M5 - 2*M1*M3*M4^2 + M6*M2^3 - 2*M2^2*M3*M5 - M2^2*M4^2 + 3*M2*M3^2*M4 - M0*M6*M2*M4 + M0*M2*M5^2 - M3^4 + M0*M6*M3^2 - 2*M0*M3*M4*M5 + M0*M4^3) - (B2*(- M6*M2^2 + M5*M2*M3 + M2*M4^2 - M3^2*M4 + M1*M6*M3 - M1*M5*M4))/(M6*M1^2*M4 - M1^2*M5^2 - 2*M6*M1*M2*M3 + 2*M1*M2*M4*M5 + 2*M1*M3^2*M5 - 2*M1*M3*M4^2 + M6*M2^3 - 2*M2^2*M3*M5 - M2^2*M4^2 + 3*M2*M3^2*M4 - M0*M6*M2*M4 + M0*M2*M5^2 - M3^4 + M0*M6*M3^2 - 2*M0*M3*M4*M5 + M0*M4^3)
S2 = (B1*(M6*M2^2 - 2*M2*M3*M5 + M4*M3^2 + M0*M5^2 - M0*M4*M6))/(2*M6*M1^2*M4 - 2*M1^2*M5^2 - 4*M6*M1*M2*M3 + 4*M1*M2*M4*M5 + 4*M1*M3^2*M5 - 4*M1*M3*M4^2 + 2*M6*M2^3 - 4*M2^2*M3*M5 - 2*M2^2*M4^2 + 6*M2*M3^2*M4 - 2*M0*M6*M2*M4 + 2*M0*M2*M5^2 - 2*M3^4 + 2*M0*M6*M3^2 - 4*M0*M3*M4*M5 + 2*M0*M4^3) + (B3*(- M2^2*M4 + M2*M3^2 + M1*M5*M2 - M1*M3*M4 - M0*M5*M3 + M0*M4^2))/(2*M6*M1^2*M4 - 2*M1^2*M5^2 - 4*M6*M1*M2*M3 + 4*M1*M2*M4*M5 + 4*M1*M3^2*M5 - 4*M1*M3*M4^2 + 2*M6*M2^3 - 4*M2^2*M3*M5 - 2*M2^2*M4^2 + 6*M2*M3^2*M4 - 2*M0*M6*M2*M4 + 2*M0*M2*M5^2 - 2*M3^4 + 2*M0*M6*M3^2 - 4*M0*M3*M4*M5 + 2*M0*M4^3) - (B0*(- M3^2*M5 + M3*M4^2 + M2*M6*M3 - M2*M4*M5 - M1*M6*M4 + M1*M5^2))/(2*M6*M1^2*M4 - 2*M1^2*M5^2 - 4*M6*M1*M2*M3 + 4*M1*M2*M4*M5 + 4*M1*M3^2*M5 - 4*M1*M3*M4^2 + 2*M6*M2^3 - 4*M2^2*M3*M5 - 2*M2^2*M4^2 + 6*M2*M3^2*M4 - 2*M0*M6*M2*M4 + 2*M0*M2*M5^2 - 2*M3^4 + 2*M0*M6*M3^2 - 4*M0*M3*M4*M5 + 2*M0*M4^3) - (B2*(M3^3 - M0*M3*M6 + M0*M4*M5 + M1*M2*M6 - M1*M3*M5 - M2*M3*M4))/(2*M6*M1^2*M4 - 2*M1^2*M5^2 - 4*M6*M1*M2*M3 + 4*M1*M2*M4*M5 + 4*M1*M3^2*M5 - 4*M1*M3*M4^2 + 2*M6*M2^3 - 4*M2^2*M3*M5 - 2*M2^2*M4^2 + 6*M2*M3^2*M4 - 2*M0*M6*M2*M4 + 2*M0*M2*M5^2 - 2*M3^4 + 2*M0*M6*M3^2 - 4*M0*M3*M4*M5 + 2*M0*M4^3)
S3 = (B2*(M6*M1^2 - 2*M1*M3*M4 + M2*M3^2 + M0*M4^2 - M0*M2*M6))/(3*M6*M1^2*M4 - 3*M1^2*M5^2 - 6*M6*M1*M2*M3 + 6*M1*M2*M4*M5 + 6*M1*M3^2*M5 - 6*M1*M3*M4^2 + 3*M6*M2^3 - 6*M2^2*M3*M5 - 3*M2^2*M4^2 + 9*M2*M3^2*M4 - 3*M0*M6*M2*M4 + 3*M0*M2*M5^2 - 3*M3^4 + 3*M0*M6*M3^2 - 6*M0*M3*M4*M5 + 3*M0*M4^3) + (B3*(- M5*M1^2 + M4*M1*M2 + M1*M3^2 - M2^2*M3 + M0*M5*M2 - M0*M4*M3))/(3*M6*M1^2*M4 - 3*M1^2*M5^2 - 6*M6*M1*M2*M3 + 6*M1*M2*M4*M5 + 6*M1*M3^2*M5 - 6*M1*M3*M4^2 + 3*M6*M2^3 - 6*M2^2*M3*M5 - 3*M2^2*M4^2 + 9*M2*M3^2*M4 - 3*M0*M6*M2*M4 + 3*M0*M2*M5^2 - 3*M3^4 + 3*M0*M6*M3^2 - 6*M0*M3*M4*M5 + 3*M0*M4^3) - (B0*(- M6*M2^2 + M5*M2*M3 + M2*M4^2 - M3^2*M4 + M1*M6*M3 - M1*M5*M4))/(3*M6*M1^2*M4 - 3*M1^2*M5^2 - 6*M6*M1*M2*M3 + 6*M1*M2*M4*M5 + 6*M1*M3^2*M5 - 6*M1*M3*M4^2 + 3*M6*M2^3 - 6*M2^2*M3*M5 - 3*M2^2*M4^2 + 9*M2*M3^2*M4 - 3*M0*M6*M2*M4 + 3*M0*M2*M5^2 - 3*M3^4 + 3*M0*M6*M3^2 - 6*M0*M3*M4*M5 + 3*M0*M4^3) - (B1*(M3^3 - M0*M3*M6 + M0*M4*M5 + M1*M2*M6 - M1*M3*M5 - M2*M3*M4))/(3*M6*M1^2*M4 - 3*M1^2*M5^2 - 6*M6*M1*M2*M3 + 6*M1*M2*M4*M5 + 6*M1*M3^2*M5 - 6*M1*M3*M4^2 + 3*M6*M2^3 - 6*M2^2*M3*M5 - 3*M2^2*M4^2 + 9*M2*M3^2*M4 - 3*M0*M6*M2*M4 + 3*M0*M2*M5^2 - 3*M3^4 + 3*M0*M6*M3^2 - 6*M0*M3*M4*M5 + 3*M0*M4^3)
S4 = (B2*(- M5*M1^2 + M4*M1*M2 + M1*M3^2 - M2^2*M3 + M0*M5*M2 - M0*M4*M3))/(4*M6*M1^2*M4 - 4*M1^2*M5^2 - 8*M6*M1*M2*M3 + 8*M1*M2*M4*M5 + 8*M1*M3^2*M5 - 8*M1*M3*M4^2 + 4*M6*M2^3 - 8*M2^2*M3*M5 - 4*M2^2*M4^2 + 12*M2*M3^2*M4 - 4*M0*M6*M2*M4 + 4*M0*M2*M5^2 - 4*M3^4 + 4*M0*M6*M3^2 - 8*M0*M3*M4*M5 + 4*M0*M4^3) + (B1*(- M2^2*M4 + M2*M3^2 + M1*M5*M2 - M1*M3*M4 - M0*M5*M3 + M0*M4^2))/(4*M6*M1^2*M4 - 4*M1^2*M5^2 - 8*M6*M1*M2*M3 + 8*M1*M2*M4*M5 + 8*M1*M3^2*M5 - 8*M1*M3*M4^2 + 4*M6*M2^3 - 8*M2^2*M3*M5 - 4*M2^2*M4^2 + 12*M2*M3^2*M4 - 4*M0*M6*M2*M4 + 4*M0*M2*M5^2 - 4*M3^4 + 4*M0*M6*M3^2 - 8*M0*M3*M4*M5 + 4*M0*M4^3) + (B3*(M4*M1^2 - 2*M1*M2*M3 + M2^3 - M0*M4*M2 + M0*M3^2))/(4*M6*M1^2*M4 - 4*M1^2*M5^2 - 8*M6*M1*M2*M3 + 8*M1*M2*M4*M5 + 8*M1*M3^2*M5 - 8*M1*M3*M4^2 + 4*M6*M2^3 - 8*M2^2*M3*M5 - 4*M2^2*M4^2 + 12*M2*M3^2*M4 - 4*M0*M6*M2*M4 + 4*M0*M2*M5^2 - 4*M3^4 + 4*M0*M6*M3^2 - 8*M0*M3*M4*M5 + 4*M0*M4^3) - (B0*(M5*M2^2 - 2*M2*M3*M4 + M3^3 - M1*M5*M3 + M1*M4^2))/(4*M6*M1^2*M4 - 4*M1^2*M5^2 - 8*M6*M1*M2*M3 + 8*M1*M2*M4*M5 + 8*M1*M3^2*M5 - 8*M1*M3*M4^2 + 4*M6*M2^3 - 8*M2^2*M3*M5 - 4*M2^2*M4^2 + 12*M2*M3^2*M4 - 4*M0*M6*M2*M4 + 4*M0*M2*M5^2 - 4*M3^4 + 4*M0*M6*M3^2 - 8*M0*M3*M4*M5 + 4*M0*M4^3)

sig = (1/(dt*Tmax))*sum(diff(X).^2)
